{"version":3,"sources":["webpack:///openseadragon-guides.js","webpack:///webpack/bootstrap f782fe738309033f7676","webpack:///./src/globals.js","webpack:///./src/session.js","webpack:///./src/guide.js","webpack:///./src/index.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","Object","defineProperty","configurable","enumerable","get","n","__esModule","o","object","property","prototype","hasOwnProperty","p","s","$","OpenSeadragon","DIRECTION_HORIZONTAL","Symbol","DIRECTION_VERTICAL","addGuide","id","x","y","dir","rotation","direction","guidesList","getGuides","guide","find","push","saveData","deleteGuide","guides","filter","data","window","sessionStorage","getItem","STORAGE_ID","JSON","parse","arr","setItem","stringify","_globals","useStorage","default","_interopRequireDefault","obj","_classCallCheck","instance","Constructor","TypeError","createElem","elem","document","createElement","classList","add","Error","createLine","lineElem","Guide","undefined","_createClass","defineProperties","target","props","length","descriptor","writable","key","protoProps","staticProps","_session","_session2","_ref","clickHandler","_ref$direction","_ref$id","Date","now","plugin","_ref$rotation","viewer","this","point","viewport","getCenter","line","appendChild","overlay","Overlay","draw","saveInStorage","allowRotation","rotate","addHandlers","tracker","MouseTracker","element","clickTimeThreshold","clickDistThreshold","dragHandler","bind","dragEndHandler","dblClickHandler","remove","addHandler","event","delta","deltaPointsFromPixels","update","drawHTML","drawer","container","removeHandler","destroy","closePopup","deg","parseFloat","style","webkitTransform","transform","_guide","version","major","Viewer","options","guidesInstance","Guides","_this","extend","horizontalGuideButton","verticalGuideButton","prefixUrl","removeOnClose","useSessionStorage","navImages","guideHorizontal","REST","GROUP","HOVER","DOWN","guideVertical","prefix","useGroup","buttons","anyButton","onFocus","onBlur","Button","getElement","tooltip","getString","srcRest","srcGroup","srcHover","srcDown","onRelease","createHorizontalGuide","createVerticalGuide","forEach","g","showPopup","popup","createRotationPopup","addControl","display","popupInput","querySelector","_this2","_this3","selectedGuide","_this4","position","bottom","left","form","background","padding","input","type","width","fontSize","rotateButton","innerHTML","addEventListener","closeButton","title","fontWeight"],"mappings":"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","file":"openseadragon-guides.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmory imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmory exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tObject.defineProperty(exports, name, {\n/******/ \t\t\tconfigurable: false,\n/******/ \t\t\tenumerable: true,\n/******/ \t\t\tget: getter\n/******/ \t\t});\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 3);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\"use strict\";\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n// Not importing Openseadragon into the bundle, use global var instead\nvar $ = exports.$ = OpenSeadragon;\n\nvar DIRECTION_HORIZONTAL = exports.DIRECTION_HORIZONTAL = Symbol('horizontal');\nvar DIRECTION_VERTICAL = exports.DIRECTION_VERTICAL = Symbol('vertical');\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _globals = __webpack_require__(0);\n\nvar useStorage = false;\nvar STORAGE_ID = 'openseadragon-guides';\n\nfunction addGuide(id, x, y, dir, rotation) {\n  var direction = dir === _globals.DIRECTION_HORIZONTAL ? 'horizontal' : 'vertical';\n  var guidesList = getGuides();\n  // Check if guide with this id already exists\n  var guide = guidesList.find(function (guide) {\n    return guide.id === id;\n  });\n\n  // If guide exists update, otherwise create new one\n  if (guide) {\n    guide.x = x;\n    guide.y = y;\n    guide.rotation = rotation;\n  } else {\n    guidesList.push({ id: id, x: x, y: y, direction: direction, rotation: rotation });\n  }\n\n  saveData(guidesList);\n}\n\nfunction deleteGuide(id) {\n  var guides = getGuides();\n\n  saveData(guides.filter(function (guide) {\n    return guide.id !== id;\n  }));\n}\n\nfunction getGuides() {\n  var data = window.sessionStorage.getItem(STORAGE_ID);\n\n  if (data) {\n    return JSON.parse(data);\n  }\n\n  return [];\n}\n\nfunction saveData(arr) {\n  window.sessionStorage.setItem(STORAGE_ID, JSON.stringify(arr));\n}\n\nexports.default = {\n  addGuide: addGuide,\n  deleteGuide: deleteGuide,\n  getGuides: getGuides,\n  useStorage: useStorage\n};\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Guide = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _globals = __webpack_require__(0);\n\nvar _session = __webpack_require__(1);\n\nvar _session2 = _interopRequireDefault(_session);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Guide = exports.Guide = function () {\n  function Guide(_ref) {\n    var clickHandler = _ref.clickHandler;\n    var _ref$direction = _ref.direction;\n    var direction = _ref$direction === undefined ? _globals.DIRECTION_HORIZONTAL : _ref$direction;\n    var _ref$id = _ref.id;\n    var id = _ref$id === undefined ? Date.now() : _ref$id;\n    var plugin = _ref.plugin;\n    var _ref$rotation = _ref.rotation;\n    var rotation = _ref$rotation === undefined ? 0 : _ref$rotation;\n    var viewer = _ref.viewer;\n    var x = _ref.x;\n    var y = _ref.y;\n\n    _classCallCheck(this, Guide);\n\n    this.viewer = viewer;\n    this.plugin = plugin;\n    this.direction = direction;\n    this.rotation = rotation;\n    this.id = id;\n\n    // Center guide by default\n    this.point = this.viewer.viewport.getCenter();\n    this.point.x = x ? x : this.point.x;\n    this.point.y = y ? y : this.point.y;\n\n    this.elem = createElem(this.direction, this.id);\n    this.line = createLine();\n    this.elem.appendChild(this.line);\n    this.overlay = new _globals.$.Overlay(this.elem, this.point);\n    this.draw();\n\n    // Store guide in session\n    this.saveInStorage();\n\n    if (clickHandler && this.plugin.allowRotation) {\n      this.clickHandler = clickHandler;\n    }\n\n    if (this.plugin.allowRotation) {\n      this.rotate(this.rotation);\n    }\n\n    this.addHandlers();\n  }\n\n  _createClass(Guide, [{\n    key: 'addHandlers',\n    value: function addHandlers() {\n      // Listen for mouse events on the guide\n      this.tracker = new _globals.$.MouseTracker({\n        element: this.elem,\n        clickTimeThreshold: this.viewer.clickTimeThreshold,\n        clickDistThreshold: this.viewer.clickDistThreshold,\n        dragHandler: this.dragHandler.bind(this),\n        dragEndHandler: this.dragEndHandler.bind(this),\n        dblClickHandler: this.remove.bind(this)\n      });\n\n      if (this.clickHandler) {\n        this.tracker.clickHandler = this.clickHandler.bind(this);\n      }\n\n      // Redraw guide when viewer changes\n      this.viewer.addHandler('open', this.draw.bind(this));\n      this.viewer.addHandler('animation', this.draw.bind(this));\n      this.viewer.addHandler('resize', this.draw.bind(this));\n      this.viewer.addHandler('rotate', this.draw.bind(this));\n    }\n  }, {\n    key: 'dragHandler',\n    value: function dragHandler(event) {\n      var delta = this.viewer.viewport.deltaPointsFromPixels(event.delta, true);\n\n      switch (this.direction) {\n        case _globals.DIRECTION_HORIZONTAL:\n          this.point.y += delta.y;\n          break;\n        case _globals.DIRECTION_VERTICAL:\n          this.point.x += delta.x;\n          break;\n      }\n\n      this.elem.classList.add('osd-guide-drag');\n      this.draw();\n    }\n  }, {\n    key: 'dragEndHandler',\n    value: function dragEndHandler() {\n      this.elem.classList.remove('osd-guide-drag');\n      this.saveInStorage();\n    }\n  }, {\n    key: 'draw',\n    value: function draw() {\n      if (this.point) {\n        this.overlay.update(this.point);\n        this.overlay.drawHTML(this.viewer.drawer.container, this.viewer.viewport);\n      }\n\n      return this;\n    }\n  }, {\n    key: 'remove',\n    value: function remove() {\n      this.viewer.removeHandler('open', this.draw.bind(this));\n      this.viewer.removeHandler('animation', this.draw.bind(this));\n      this.viewer.removeHandler('resize', this.draw.bind(this));\n      this.viewer.removeHandler('rotate', this.draw.bind(this));\n\n      this.overlay.destroy();\n      this.point = null;\n\n      _session2.default.deleteGuide(this.id);\n\n      if (this.plugin.allowRotation) {\n        this.plugin.closePopup();\n      }\n\n      return this;\n    }\n  }, {\n    key: 'rotate',\n    value: function rotate(deg) {\n      if (parseFloat(deg)) {\n        switch (this.direction) {\n          case _globals.DIRECTION_HORIZONTAL:\n            this.line.style.webkitTransform = 'rotateZ(' + deg + 'deg)';\n            this.line.style.transform = 'rotateZ(' + deg + 'deg)';\n            break;\n          case _globals.DIRECTION_VERTICAL:\n            this.line.style.webkitTransform = 'rotateZ(' + deg + 'deg)';\n            this.line.style.transform = 'rotateZ(' + deg + 'deg)';\n            break;\n        }\n        this.rotation = deg;\n      } else {\n        this.line.style.webkitTransform = '';\n        this.line.style.transform = '';\n        this.rotation = 0;\n      }\n      this.saveInStorage();\n    }\n  }, {\n    key: 'saveInStorage',\n    value: function saveInStorage() {\n      if (_session2.default.useStorage) {\n        _session2.default.addGuide(this.id, this.point.x, this.point.y, this.direction, this.rotation);\n      }\n    }\n  }]);\n\n  return Guide;\n}();\n\nfunction createElem(direction, id) {\n  var elem = document.createElement('div');\n  elem.id = 'osd-guide-' + id;\n  elem.classList.add('osd-guide');\n\n  switch (direction) {\n    case _globals.DIRECTION_HORIZONTAL:\n      elem.classList.add('osd-guide-horizontal');\n      break;\n    case _globals.DIRECTION_VERTICAL:\n      elem.classList.add('osd-guide-vertical');\n      break;\n    default:\n      throw new Error('Invalid guide direction');\n  }\n\n  return elem;\n}\n\nfunction createLine() {\n  var lineElem = document.createElement('div');\n  lineElem.classList.add('osd-guide-line');\n  return lineElem;\n}\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n'use strict';\n\nvar _guide = __webpack_require__(2);\n\nvar _globals = __webpack_require__(0);\n\nvar _session = __webpack_require__(1);\n\nvar _session2 = _interopRequireDefault(_session);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nif (!_globals.$.version || _globals.$.version.major < 2) {\n  throw new Error('This version of OpenSeadragon Guides requires OpenSeadragon version 2.0.0+');\n}\n\n_globals.$.Viewer.prototype.guides = function (options) {\n  if (!this.guidesInstance || options) {\n    options = options || {};\n    options.viewer = this;\n    this.guidesInstance = new _globals.$.Guides(options);\n  }\n\n  return this.guidesInstance;\n};\n\n_globals.$.Guides = function (options) {\n  var _this = this;\n\n  _globals.$.extend(true, this, {\n    // internal state properties\n    viewer: null,\n    guides: [],\n\n    // options\n    allowRotation: false,\n    horizontalGuideButton: null,\n    verticalGuideButton: null,\n    prefixUrl: null,\n    removeOnClose: false,\n    useSessionStorage: false,\n    navImages: {\n      guideHorizontal: {\n        REST: 'guidehorizontal_rest.png',\n        GROUP: 'guidehorizontal_grouphover.png',\n        HOVER: 'guidehorizontal_hover.png',\n        DOWN: 'guidehorizontal_pressed.png'\n      },\n      guideVertical: {\n        REST: 'guidevertical_rest.png',\n        GROUP: 'guidevertical_grouphover.png',\n        HOVER: 'guidevertical_hover.png',\n        DOWN: 'guidevertical_pressed.png'\n      }\n    }\n  }, options);\n\n  _globals.$.extend(true, this.navImages, this.viewer.navImages);\n\n  var prefix = this.prefixUrl || this.viewer.prefixUrl || '';\n  var useGroup = this.viewer.buttons && this.viewer.buttons.buttons;\n  var anyButton = useGroup ? this.viewer.buttons.buttons[0] : null;\n  var onFocus = anyButton ? anyButton.onFocus : null;\n  var onBlur = anyButton ? anyButton.onBlur : null;\n\n  this.horizontalGuideButton = new _globals.$.Button({\n    element: this.horizontalGuideButton ? _globals.$.getElement(this.horizontalGuideButton) : null,\n    clickTimeThreshold: this.viewer.clickTimeThreshold,\n    clickDistThreshold: this.viewer.clickDistThreshold,\n    tooltip: _globals.$.getString('Tooltips.HorizontalGuide') || 'Horizontal guide',\n    srcRest: prefix + this.navImages.guideHorizontal.REST,\n    srcGroup: prefix + this.navImages.guideHorizontal.GROUP,\n    srcHover: prefix + this.navImages.guideHorizontal.HOVER,\n    srcDown: prefix + this.navImages.guideHorizontal.DOWN,\n    onRelease: this.createHorizontalGuide.bind(this),\n    onFocus: onFocus,\n    onBlur: onBlur\n  });\n\n  this.verticalGuideButton = new _globals.$.Button({\n    element: this.verticalGuideButton ? _globals.$.getElement(this.verticalGuideButton) : null,\n    clickTimeThreshold: this.viewer.clickTimeThreshold,\n    clickDistThreshold: this.viewer.clickDistThreshold,\n    tooltip: _globals.$.getString('Tooltips.VerticalGuide') || 'vertical guide',\n    srcRest: prefix + this.navImages.guideVertical.REST,\n    srcGroup: prefix + this.navImages.guideVertical.GROUP,\n    srcHover: prefix + this.navImages.guideVertical.HOVER,\n    srcDown: prefix + this.navImages.guideVertical.DOWN,\n    onRelease: this.createVerticalGuide.bind(this),\n    onFocus: onFocus,\n    onBlur: onBlur\n  });\n\n  if (useGroup) {\n    this.viewer.buttons.buttons.push(this.horizontalGuideButton);\n    this.viewer.buttons.element.appendChild(this.horizontalGuideButton.element);\n    this.viewer.buttons.buttons.push(this.verticalGuideButton);\n    this.viewer.buttons.element.appendChild(this.verticalGuideButton.element);\n  }\n\n  // Store globally so it can be used in the Guide objects\n  _session2.default.useStorage = this.useSessionStorage;\n\n  // Check if any guides are stored in sessionStorage\n  if (_session2.default.useStorage) {\n    var guides = _session2.default.getGuides();\n\n    guides.forEach(function (guide) {\n      var g = new _guide.Guide({\n        viewer: _this.viewer,\n        direction: guide.direction === 'horizontal' ? _globals.DIRECTION_HORIZONTAL : _globals.DIRECTION_VERTICAL,\n        rotation: guide.rotation,\n        id: guide.id,\n        clickHandler: function clickHandler() {\n          return _this.showPopup(g);\n        },\n        plugin: _this,\n        x: guide.x,\n        y: guide.y\n      });\n\n      _this.guides.push(g);\n    });\n  }\n\n  // Remove guides when viewer closes\n  if (this.removeOnClose) {\n    this.viewer.addHandler('close', function () {\n      _this.guides.forEach(function (guide) {\n        return guide.remove();\n      });\n      _this.guides = [];\n    });\n  }\n\n  if (this.allowRotation) {\n    this.popup = this.createRotationPopup();\n    this.viewer.addControl(this.popup, {});\n    this.popup.style.display = 'none'; //add Controll sets display:block\n    this.popupInput = this.popup.querySelector('input');\n  }\n};\n\n_globals.$.extend(_globals.$.Guides.prototype, {\n  createHorizontalGuide: function createHorizontalGuide() {\n    var _this2 = this;\n\n    var guide = new _guide.Guide({\n      viewer: this.viewer,\n      plugin: this,\n      direction: _globals.DIRECTION_HORIZONTAL,\n      clickHandler: function clickHandler() {\n        return _this2.showPopup(guide);\n      }\n    });\n    this.guides.push(guide);\n  },\n  createVerticalGuide: function createVerticalGuide() {\n    var _this3 = this;\n\n    var guide = new _guide.Guide({\n      viewer: this.viewer,\n      plugin: this,\n      direction: _globals.DIRECTION_VERTICAL,\n      clickHandler: function clickHandler() {\n        return _this3.showPopup(guide);\n      }\n    });\n    this.guides.push(guide);\n  },\n  showPopup: function showPopup(guide) {\n    this.popup.style.display = 'block';\n    this.selectedGuide = guide;\n    this.popupInput.value = this.selectedGuide.rotation;\n  },\n  closePopup: function closePopup() {\n    this.popup.style.display = 'none';\n    this.popupInput.value = '';\n    this.selectedGuide = null;\n  },\n\n\n  // TODO: Refactor popup into new class\n  createRotationPopup: function createRotationPopup() {\n    var _this4 = this;\n\n    var popup = document.createElement('div');\n    popup.id = 'osd-guide-popup';\n    popup.classList.add('osd-guide-popup');\n    popup.style.position = 'absolute';\n    popup.style.bottom = '10px';\n    popup.style.left = '10px';\n\n    var form = document.createElement('form');\n    form.classList.add('osd-guide-popup-form');\n    form.style.display = 'block';\n    form.style.position = 'relative';\n    form.style.background = '#fff';\n    form.style.padding = '10px';\n\n    popup.appendChild(form);\n\n    var input = document.createElement('input');\n    input.type = 'text';\n    input.style.display = 'inline-block';\n    input.style.width = '50px';\n    input.style.fontSize = '14px';\n    form.appendChild(input);\n\n    var rotateButton = document.createElement('button');\n    rotateButton.type = 'submit';\n    rotateButton.innerHTML = _globals.$.getString('Tool.rotate') || 'rotate';\n    rotateButton.style.fontSize = '14px';\n    rotateButton.classList.add('osd-guide-rotate-button');\n\n    rotateButton.addEventListener('click', function () {\n      _this4.selectedGuide.rotate(input.value);\n      _this4.closePopup();\n    });\n\n    form.appendChild(rotateButton);\n\n    var closeButton = document.createElement('button');\n    closeButton.innerHTML = '&times;';\n    closeButton.title = _globals.$.getString('Tool.close') || 'close';\n    closeButton.style.fontWeight = 'bold';\n    closeButton.style.fontSize = '14px';\n    closeButton.classList.add('osd-guide-close');\n    closeButton.addEventListener('click', function () {\n      _this4.closePopup();\n    });\n    form.appendChild(closeButton);\n\n    return popup;\n  }\n});\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// openseadragon-guides.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f782fe738309033f7676","// Not importing Openseadragon into the bundle, use global var instead\nexport const $ = OpenSeadragon;\n\nexport const DIRECTION_HORIZONTAL = Symbol('horizontal');\nexport const DIRECTION_VERTICAL = Symbol('vertical');\n\n\n\n// WEBPACK FOOTER //\n// ./src/globals.js","import {DIRECTION_HORIZONTAL} from './globals';\n\nlet useStorage = false;\nconst STORAGE_ID = 'openseadragon-guides';\n\nfunction addGuide(id, x, y, dir, rotation) {\n  const direction = dir === DIRECTION_HORIZONTAL ? 'horizontal' : 'vertical';\n  const guidesList = getGuides();\n  // Check if guide with this id already exists\n  const guide = guidesList.find(guide => guide.id === id);\n\n  // If guide exists update, otherwise create new one\n  if (guide) {\n    guide.x = x;\n    guide.y = y;\n    guide.rotation = rotation;\n  } else {\n    guidesList.push({id, x, y, direction, rotation});\n  }\n\n  saveData(guidesList);\n}\n\nfunction deleteGuide(id) {\n  const guides = getGuides();\n\n  saveData(guides.filter(guide => guide.id !== id));\n}\n\nfunction getGuides() {\n  const data = window.sessionStorage.getItem(STORAGE_ID);\n\n  if (data) {\n    return JSON.parse(data);\n  }\n\n  return [];\n}\n\nfunction saveData(arr) {\n  window.sessionStorage.setItem(\n    STORAGE_ID,\n    JSON.stringify(arr)\n  );\n}\n\nexport default {\n  addGuide,\n  deleteGuide,\n  getGuides,\n  useStorage\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/session.js","import {$, DIRECTION_HORIZONTAL, DIRECTION_VERTICAL} from './globals';\nimport session from './session';\n\nexport class Guide {\n\n  constructor({\n    clickHandler,\n    direction = DIRECTION_HORIZONTAL,\n    id = Date.now(),\n    plugin,\n    rotation = 0,\n    viewer,\n    x,\n    y\n  }) {\n    this.viewer = viewer;\n    this.plugin = plugin;\n    this.direction = direction;\n    this.rotation = rotation;\n    this.id = id;\n\n    // Center guide by default\n    this.point = this.viewer.viewport.getCenter();\n    this.point.x = x ? x : this.point.x;\n    this.point.y = y ? y : this.point.y;\n\n    this.elem = createElem(this.direction, this.id);\n    this.line = createLine();\n    this.elem.appendChild(this.line);\n    this.overlay = new $.Overlay(this.elem, this.point);\n    this.draw();\n\n    // Store guide in session\n    this.saveInStorage();\n\n    if(clickHandler && this.plugin.allowRotation) {\n      this.clickHandler = clickHandler;\n    }\n\n    if(this.plugin.allowRotation) {\n      this.rotate(this.rotation);\n    }\n\n    this.addHandlers();\n  }\n\n  addHandlers() {\n    // Listen for mouse events on the guide\n    this.tracker = new $.MouseTracker({\n      element: this.elem,\n      clickTimeThreshold: this.viewer.clickTimeThreshold,\n      clickDistThreshold: this.viewer.clickDistThreshold,\n      dragHandler: this.dragHandler.bind(this),\n      dragEndHandler: this.dragEndHandler.bind(this),\n      dblClickHandler: this.remove.bind(this)\n    });\n\n    if (this.clickHandler) {\n      this.tracker.clickHandler = this.clickHandler.bind(this);\n    }\n\n    // Redraw guide when viewer changes\n    this.viewer.addHandler('open', this.draw.bind(this));\n    this.viewer.addHandler('animation', this.draw.bind(this));\n    this.viewer.addHandler('resize', this.draw.bind(this));\n    this.viewer.addHandler('rotate', this.draw.bind(this));\n  }\n\n  dragHandler(event) {\n    const delta = this.viewer.viewport.deltaPointsFromPixels(event.delta, true);\n\n    switch (this.direction) {\n      case DIRECTION_HORIZONTAL:\n        this.point.y += delta.y;\n        break;\n      case DIRECTION_VERTICAL:\n        this.point.x += delta.x;\n        break;\n    }\n\n    this.elem.classList.add('osd-guide-drag');\n    this.draw();\n  }\n\n  dragEndHandler() {\n    this.elem.classList.remove('osd-guide-drag');\n    this.saveInStorage();\n  }\n\n  draw() {\n    if (this.point) {\n      this.overlay.update(this.point);\n      this.overlay.drawHTML(this.viewer.drawer.container, this.viewer.viewport);\n    }\n\n    return this;\n  }\n\n  remove() {\n    this.viewer.removeHandler('open', this.draw.bind(this));\n    this.viewer.removeHandler('animation', this.draw.bind(this));\n    this.viewer.removeHandler('resize', this.draw.bind(this));\n    this.viewer.removeHandler('rotate', this.draw.bind(this));\n\n    this.overlay.destroy();\n    this.point = null;\n\n    session.deleteGuide(this.id);\n\n    if (this.plugin.allowRotation) {\n      this.plugin.closePopup();\n    }\n\n    return this;\n  }\n\n  rotate(deg) {\n    if (parseFloat(deg)) {\n      switch (this.direction) {\n        case DIRECTION_HORIZONTAL:\n          this.line.style.webkitTransform = `rotateZ(${deg}deg)`;\n          this.line.style.transform = `rotateZ(${deg}deg)`;\n          break;\n        case DIRECTION_VERTICAL:\n          this.line.style.webkitTransform = `rotateZ(${deg}deg)`;\n          this.line.style.transform = `rotateZ(${deg}deg)`;\n          break;\n      }\n      this.rotation = deg;\n    } else {\n      this.line.style.webkitTransform = '';\n      this.line.style.transform = '';\n      this.rotation = 0;\n    }\n    this.saveInStorage();\n  }\n\n  saveInStorage() {\n    if (session.useStorage) {\n      session.addGuide(\n        this.id,\n        this.point.x,\n        this.point.y,\n        this.direction,\n        this.rotation\n      );\n    }\n  }\n}\n\nfunction createElem(direction, id) {\n  const elem = document.createElement('div');\n  elem.id = `osd-guide-${id}`;\n  elem.classList.add('osd-guide');\n\n  switch (direction) {\n    case DIRECTION_HORIZONTAL:\n      elem.classList.add('osd-guide-horizontal');\n      break;\n    case DIRECTION_VERTICAL:\n      elem.classList.add('osd-guide-vertical');\n      break;\n    default:\n      throw new Error('Invalid guide direction');\n  }\n\n  return elem;\n}\n\nfunction createLine() {\n  const lineElem = document.createElement('div');\n  lineElem.classList.add('osd-guide-line');\n  return lineElem;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/guide.js","import {Guide} from './guide';\nimport {$, DIRECTION_HORIZONTAL, DIRECTION_VERTICAL} from './globals';\nimport session from './session';\n\nif (!$.version || $.version.major < 2) {\n  throw new Error(\n    'This version of OpenSeadragon Guides requires OpenSeadragon version 2.0.0+'\n  );\n}\n\n$.Viewer.prototype.guides = function(options) {\n  if (!this.guidesInstance || options) {\n    options = options || {};\n    options.viewer = this;\n    this.guidesInstance = new $.Guides(options);\n  }\n\n  return this.guidesInstance;\n};\n\n$.Guides = function(options) {\n  $.extend(true, this, {\n    // internal state properties\n    viewer: null,\n    guides: [],\n\n    // options\n    allowRotation: false,\n    horizontalGuideButton: null,\n    verticalGuideButton: null,\n    prefixUrl: null,\n    removeOnClose: false,\n    useSessionStorage: false,\n    navImages: {\n      guideHorizontal: {\n        REST: 'guidehorizontal_rest.png',\n        GROUP: 'guidehorizontal_grouphover.png',\n        HOVER: 'guidehorizontal_hover.png',\n        DOWN: 'guidehorizontal_pressed.png'\n      },\n      guideVertical: {\n        REST: 'guidevertical_rest.png',\n        GROUP: 'guidevertical_grouphover.png',\n        HOVER: 'guidevertical_hover.png',\n        DOWN: 'guidevertical_pressed.png'\n      }\n    }\n  }, options);\n\n  $.extend(true, this.navImages, this.viewer.navImages);\n\n  const prefix = this.prefixUrl || this.viewer.prefixUrl || '';\n  const useGroup = this.viewer.buttons && this.viewer.buttons.buttons;\n  const anyButton = useGroup ? this.viewer.buttons.buttons[0] : null;\n  const onFocus = anyButton ? anyButton.onFocus : null;\n  const onBlur = anyButton ? anyButton.onBlur : null;\n\n  this.horizontalGuideButton = new $.Button({\n    element: this.horizontalGuideButton ? $.getElement(this.horizontalGuideButton) : null,\n    clickTimeThreshold: this.viewer.clickTimeThreshold,\n    clickDistThreshold: this.viewer.clickDistThreshold,\n    tooltip: $.getString('Tooltips.HorizontalGuide') || 'Horizontal guide',\n    srcRest: prefix + this.navImages.guideHorizontal.REST,\n    srcGroup: prefix + this.navImages.guideHorizontal.GROUP,\n    srcHover: prefix + this.navImages.guideHorizontal.HOVER,\n    srcDown: prefix + this.navImages.guideHorizontal.DOWN,\n    onRelease: this.createHorizontalGuide.bind(this),\n    onFocus,\n    onBlur\n  });\n\n  this.verticalGuideButton = new $.Button({\n    element: this.verticalGuideButton ? $.getElement(this.verticalGuideButton) : null,\n    clickTimeThreshold: this.viewer.clickTimeThreshold,\n    clickDistThreshold: this.viewer.clickDistThreshold,\n    tooltip: $.getString('Tooltips.VerticalGuide') || 'vertical guide',\n    srcRest: prefix + this.navImages.guideVertical.REST,\n    srcGroup: prefix + this.navImages.guideVertical.GROUP,\n    srcHover: prefix + this.navImages.guideVertical.HOVER,\n    srcDown: prefix + this.navImages.guideVertical.DOWN,\n    onRelease: this.createVerticalGuide.bind(this),\n    onFocus,\n    onBlur\n  });\n\n  if (useGroup) {\n    this.viewer.buttons.buttons.push(this.horizontalGuideButton);\n    this.viewer.buttons.element.appendChild(this.horizontalGuideButton.element);\n    this.viewer.buttons.buttons.push(this.verticalGuideButton);\n    this.viewer.buttons.element.appendChild(this.verticalGuideButton.element);\n  }\n\n  // Store globally so it can be used in the Guide objects\n  session.useStorage = this.useSessionStorage;\n\n  // Check if any guides are stored in sessionStorage\n  if (session.useStorage) {\n    const guides = session.getGuides();\n\n    guides.forEach(guide => {\n      const g = new Guide({\n        viewer: this.viewer,\n        direction: guide.direction === 'horizontal' ?\n          DIRECTION_HORIZONTAL :\n          DIRECTION_VERTICAL,\n        rotation: guide.rotation,\n        id: guide.id,\n        clickHandler: () => this.showPopup(g),\n        plugin: this,\n        x: guide.x,\n        y: guide.y\n      });\n\n      this.guides.push(g);\n    });\n  }\n\n  // Remove guides when viewer closes\n  if (this.removeOnClose) {\n    this.viewer.addHandler('close', () => {\n      this.guides.forEach(guide => guide.remove());\n      this.guides = [];\n    });\n  }\n\n  if (this.allowRotation) {\n    this.popup = this.createRotationPopup();\n    this.viewer.addControl(this.popup, {});\n    this.popup.style.display = 'none'; //add Controll sets display:block\n    this.popupInput = this.popup.querySelector('input');\n  }\n};\n\n$.extend($.Guides.prototype, {\n  createHorizontalGuide() {\n    const guide = new Guide({\n      viewer: this.viewer,\n      plugin: this,\n      direction: DIRECTION_HORIZONTAL,\n      clickHandler: () => this.showPopup(guide)\n    });\n    this.guides.push(guide);\n  },\n\n  createVerticalGuide() {\n    const guide = new Guide({\n      viewer: this.viewer,\n      plugin: this,\n      direction: DIRECTION_VERTICAL,\n      clickHandler: () => this.showPopup(guide)\n    });\n    this.guides.push(guide);\n  },\n\n  showPopup(guide) {\n    this.popup.style.display = 'block';\n    this.selectedGuide = guide;\n    this.popupInput.value = this.selectedGuide.rotation;\n  },\n\n  closePopup() {\n    this.popup.style.display = 'none';\n    this.popupInput.value = '';\n    this.selectedGuide = null;\n  },\n\n  // TODO: Refactor popup into new class\n  createRotationPopup() {\n    const popup = document.createElement('div');\n    popup.id = 'osd-guide-popup';\n    popup.classList.add('osd-guide-popup');\n    popup.style.position = 'absolute';\n    popup.style.bottom = '10px';\n    popup.style.left = '10px';\n\n    const form = document.createElement('form');\n    form.classList.add('osd-guide-popup-form');\n    form.style.display = 'block';\n    form.style.position = 'relative';\n    form.style.background = '#fff';\n    form.style.padding = '10px';\n\n    popup.appendChild(form);\n\n    const input = document.createElement('input');\n    input.type = 'text';\n    input.style.display = 'inline-block';\n    input.style.width = '50px';\n    input.style.fontSize = '14px';\n    form.appendChild(input);\n\n    const rotateButton = document.createElement('button');\n    rotateButton.type = 'submit';\n    rotateButton.innerHTML = $.getString('Tool.rotate') || 'rotate';\n    rotateButton.style.fontSize = '14px';\n    rotateButton.classList.add('osd-guide-rotate-button');\n\n    rotateButton.addEventListener('click', () => {\n      this.selectedGuide.rotate(input.value);\n      this.closePopup();\n    });\n\n    form.appendChild(rotateButton);\n\n    const closeButton = document.createElement('button');\n    closeButton.innerHTML = '&times;';\n    closeButton.title = $.getString('Tool.close') || 'close';\n    closeButton.style.fontWeight = 'bold';\n    closeButton.style.fontSize = '14px';\n    closeButton.classList.add('osd-guide-close');\n    closeButton.addEventListener('click', () => {\n      this.closePopup();\n    });\n    form.appendChild(closeButton);\n\n    return popup;\n  }\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}